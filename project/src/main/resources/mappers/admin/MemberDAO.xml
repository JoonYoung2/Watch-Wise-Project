<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.watch.project.repository.admin.AdminMemberRepository">
	<resultMap type="com.watch.project.dto.admin.MemberDTO" id="member">
		<result column="num" property="num" />
		<result column="id" property="id" />
		<result column="user_email" property="userEmail" />
		<result column="user_pw" property="userPw" />
		<result column="user_name" property="userName" />
		<result column="kakao_agreement" property="kakaoAgreement" />
		<result column="naver_agreement" property="naverAgreement" />
		<result column="google_agreement" property="googleAgreement" />
	</resultMap>
	
	<resultMap type="com.watch.project.dto.admin.BlackListDTO" id="blackList">
		<id property="id" column="id"/>
		<result property="reportedComment" column="reported_comment"/>
		<result property="authorEmail" column="author_email"/>
		<result property="reporterEmail" column="reporter_email"/>
		<result property="reportedDate" column="reported_date"/>
	</resultMap>
	
	<select id="getMemberInfoListByStartAndEnd" resultMap="member">
		<![CDATA[SELECT * FROM 
		(SELECT ROWNUM AS num, ${columns}
		FROM (SELECT * FROM ${tableNm} ORDER BY ${orderByColumn} DESC))
		WHERE num >= ${start} AND num <= ${end}]]>
	</select>
	
	<select id="getMemberInfoListByStartAndEndQuery" resultMap="member">
		<![CDATA[SELECT * FROM 
		(SELECT ROWNUM AS num, ${columns}
		FROM (SELECT * FROM ${tableNm} WHERE ${conditionColumn} ORDER BY ${orderByColumn} DESC))
		WHERE num >= ${start} AND num <= ${end}]]>
	</select>	
	
	<delete id="deleteMember" parameterType="String">
		DELETE FROM member_info WHERE user_email =#{userEmail}
	</delete>
	
	<insert id="saveReportDatas" parameterType="com.watch.project.dto.admin.BlackListDTO">
		INSERT INTO black_list VALUES(#{id}, #{reportedComment}, #{authorEmail}, #{reporterEmail}, #{reportedDate})
	</insert>
</mapper>